<!DOCTYPE html>
<html>
<head>
	<link rel="stylesheet" type="text/css" href="assets/fonts/caslon-web/stylesheet.css"/>
	<link rel="stylesheet" type="text/css" href="assets/fonts/brandon-text-web/stylesheet.css"/>
	<link rel="stylesheet" type="text/css" href="css/style.css"/>
	<title>LiNK (dev page)</title>
</head>
<body>
	<div id="title">
		<div class="main">
			<h1>home</h1>
			<h2>a charity project for Liberty in North Korea.</h2>
		</div>
	</div>
	<div id="quoteInput">
		<div class="main">
			<h1>What is home?</h1>
			<form id="prompt">
				<textarea maxlength="250" rows="3" spellcheck="false" id="userAnswer" class="textinput" type="text" id="answer" autofocus autocomplete="off"></textarea>
			</form>
			<div class="remaining"><span id="userAnswerRemaining">250</span> characters remaining</div>
			<div id="userSubmitQuote"></div>
		</div>
	</div>
	<div id="quoteBoxMain">
		<div class="main">
			<h1>Home is...</h1>
			<h2 class="quoteAnswer"></h2>
			<h2 class="username"></h2>
			<div class="close">close</div>
		</div>
	</div>
	<div id="container"></div>
</body>
<script type="vsh" id="vertexShader">
	
	varying vec3 vNormal;
	void main() 
	{
	    vNormal = normalize( normalMatrix * normal );
	    gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
	}

</script>
<script type="fsh" id="fragmentShader">

	uniform float c;
	uniform float p;
	varying vec3 vNormal;

	void main() 
	{
		float intensity = pow( c - dot( vNormal, vec3( 0.0, 0.0, 1.0 ) ), p ); 
		gl_FragColor = vec4( 1.0, 1.0, 1.0, 1.0 ) * intensity;
	}

</script>

<script type="vsh" id="globeVertex">

	uniform vec3 avatarPos;
	uniform float appearAmt; //0->1 how many meshes appear around avatar
	uniform float maxDist;

	attribute vec3 vOffset;

	varying vec3 testColor;
	varying float opacity;

	float rand(float n){return fract(sin(n) * 43758.5453123);}

	void main() 
	{
	    vec4 mPosition = modelMatrix * vec4(vOffset, 1.);
	    float scale = rand(vOffset.x);
	    mPosition.xyz += position * 3.*scale;

	    float dist = distance(mPosition.xyz, avatarPos);
	    opacity = (maxDist - distance(mPosition.xyz, avatarPos)) / maxDist;
	    opacity = clamp(opacity, 0., 1.);

	    float appear = step( 1.-appearAmt, rand(scale) );
	    opacity *= appear;

	    testColor = (viewMatrix * mPosition).xyz;

	    gl_Position = projectionMatrix * viewMatrix * mPosition;
	}

</script>
<script type="fsh" id="globeFragment">

	uniform vec3 avatarPos;

	varying vec3 testColor;
	varying float opacity;

	void main() 
	{
		// float intensity = pow( c - dot( vNormal, vec3( 0.0, 0.0, 1.0 ) ), p ); 
		// gl_FragColor = vec4( 1.0, 1.0, 1.0, 1.0 ) * intensity;
		gl_FragColor = vec4( vec3(1.), opacity);
		// gl_FragColor = vec4( normalize(testColor), opacity );
	}

</script>

<script src="node_modules/d3-geo/build/d3-geo.min.js"></script>
<script src="node_modules/three/build/three.js"></script>
<script src="node_modules/three/examples/js/controls/OrbitControls.js"></script>
<script src="node_modules/three/examples/js/modifiers/SubdivisionModifier.js"></script>
<script src="node_modules/three/examples/js/utils/GeometryUtils.js"></script>
<script src="src/js/util.js"></script>
<script src="src/js/data.js"></script>
<script src="src/js/Loader.js"></script>
<script src="src/js/Globe.js"></script>
<script src="src/js/GlowMesh.js"></script>
<script src="src/js/Avatar.js"></script>
<script src="src/js/main.js"></script>
<script src="src/js/Submit.js"></script>
</html>